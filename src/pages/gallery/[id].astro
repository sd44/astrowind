---
import { Image } from 'astro:assets';
import { getCollection } from 'astro:content';

import GalleryLayout from '~/layouts/GalleryLayout.astro';
import { getAlbumImages } from '~/utils/albums';

export async function getStaticPaths() {
  const albums = await getCollection('albums');

  const paths = Object.values(albums).map((album) => {
    return {
      params: {
        id: album.id,
      },
      props: {
        album,
      },
    };
  });

  return paths;
}

const { album } = Astro.props;
const images = await getAlbumImages(album.id);
---

<style>
  [data-album-image] {
    display: inline-block;
    height: auto;
    margin-bottom: 1rem;
  }
</style>

<GalleryLayout title={album.data.title}>
  <div class='text-center'>
    <h1 class='font-bold text-5xl'>
      {album.data.title}
    </h1>
    <p class='my-4 text-xl'>
      {album.data.description}
    </p>

    <div class='sm:columns-2 md:columns-3 lg:columns-4 xl:columns-5 mx-auto my-8 text-center'>
      {
        images.map((image) => (
          <Image
            src={image}
            alt={`Image from ${album.data.title} album`}
            format='avif'
            quality={50}
            class='inline-block hover:shadow-lg mb-4 border hover:border-gray-300 border-transparent rounded transition-all duration-300 ease-in-out'
            loading='lazy'
            data-album-image
          />
        ))
      }
    </div>

    <p class='my-4 text-lg text-center'>
      <a href='/gallery/' class='hover:underline'>View other albums</a>
    </p>
  </div>
</GalleryLayout>
